test sulel catene e strike

================================================================================
TEST: EXPIRATION CHAINS & STRIKES - ALL SINKS & INTERVALS
================================================================================

ğŸ“Š Scansione dati disponibili...
âœ… Trovate 13 serie di dati per opzioni


================================================================================
TESTING: TLRY - tick - sink=csv
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 11 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21   1403
2025-11-28    508
2025-12-05    232
2025-12-12     76
2025-12-19   1030

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 13 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-11-07    407
2025-11-14   1153
2025-11-21   1403
2025-11-28    508
2025-12-05    232

Ultime 5 expiration:
expiration  count
2026-01-16   1372
2026-03-20    622
2026-06-18    149
2027-01-15    751
2028-01-21    236

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-11-14 â†’ 2027-01-15
âœ… OK: Trovate 11 expiration nel range
expiration  count
2025-11-14   1153
2025-11-21   1403
2025-11-28    508
2025-12-05    232
2025-12-12     76
2025-12-19   1030
2025-12-26     86
2026-01-16   1372
2026-03-20    622
2026-06-18    149
2027-01-15    751

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 13 expiration (totale 109 strike unici)

Prime 3 expiration con i loro strike:
  2025-11-07: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-11-14: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5] (9 strike)
  2025-11-21: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.0, 4.5] (8 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-11-07', '2025-11-14']
âœ… OK: Trovati strike per 2 expiration
  2025-11-07: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-11-14: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5] (9 strike)

================================================================================
TESTING: TLRY - 5m - sink=csv
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 11 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21   1659
2025-11-28   1422
2025-12-05   1264
2025-12-12    790
2025-12-19   2133

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 13 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-11-07   1514
2025-11-14   1975
2025-11-21   1659
2025-11-28   1422
2025-12-05   1264

Ultime 5 expiration:
expiration  count
2026-01-16   2528
2026-03-20   2291
2026-06-18   1185
2027-01-15   1659
2028-01-21   1896

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-11-14 â†’ 2027-01-15
âœ… OK: Trovate 11 expiration nel range
expiration  count
2025-11-14   1975
2025-11-21   1659
2025-11-28   1422
2025-12-05   1264
2025-12-12    790
2025-12-19   2133
2025-12-26    711
2026-01-16   2528
2026-03-20   2291
2026-06-18   1185
2027-01-15   1659

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 13 expiration (totale 104 strike unici)

Prime 3 expiration con i loro strike:
  2025-11-07: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-11-14: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.5] (8 strike)
  2025-11-21: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.5] (7 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-11-07', '2025-11-14']
âœ… OK: Trovati strike per 2 expiration
  2025-11-07: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-11-14: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.5] (8 strike)

================================================================================
TESTING: TLRY - 1d - sink=csv
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 12 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21    826
2025-11-28    464
2025-12-05    190
2025-12-12    110
2025-12-19   1132

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 25 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-08-22     24
2025-08-29     84
2025-09-05    132
2025-09-12    186
2025-09-19    240

Ultime 5 expiration:
expiration  count
2026-01-16   1492
2026-03-20   1132
2026-06-18    252
2027-01-15   1098
2028-01-21    812

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-08-29 â†’ 2027-01-15
âœ… OK: Trovate 23 expiration nel range
expiration  count
2025-08-29     84
2025-09-05    132
2025-09-12    186
2025-09-19    240
2025-09-26    306
2025-10-03    362
2025-10-10    392
2025-10-17    650
2025-10-24    490
2025-10-31    512
2025-11-07    520
2025-11-14    532
2025-11-21    826
2025-11-28    464
2025-12-05    190
2025-12-12    110
2025-12-19   1132
2025-12-26     60
2026-01-02     10
2026-01-16   1492
2026-03-20   1132
2026-06-18    252
2027-01-15   1098

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 25 expiration (totale 205 strike unici)

Prime 3 expiration con i loro strike:
  2025-08-22: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-08-29: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-09-05: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-08-22', '2025-08-29']
âœ… OK: Trovati strike per 2 expiration
  2025-08-22: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-08-29: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

================================================================================
TESTING: ASST - tick - sink=influxdb
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 11 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21  36607
2025-11-28   5486
2025-12-05   2453
2025-12-12    149
2025-12-19  13696

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 19 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-09-26   3692
2025-10-03   3793
2025-10-10   9076
2025-10-17  25226
2025-10-24   3292

Ultime 5 expiration:
expiration  count
2026-03-20  12629
2026-06-18   5123
2026-10-16   3262
2027-01-15  11176
2028-01-21   5582

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-10-03 â†’ 2027-01-15
âœ… OK: Trovate 17 expiration nel range
expiration  count
2025-10-03   3793
2025-10-10   9076
2025-10-17  25226
2025-10-24   3292
2025-10-31  52759
2025-11-07  22567
2025-11-14  10846
2025-11-21  36607
2025-11-28   5486
2025-12-05   2453
2025-12-12    149
2025-12-19  13696
2026-01-16  32358
2026-03-20  12629
2026-06-18   5123
2026-10-16   3262
2027-01-15  11176

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 19 expiration (totale 325 strike unici)

Prime 3 expiration con i loro strike:
  2025-09-26: [1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5]... (21 strike)
  2025-10-03: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0]... (24 strike)
  2025-10-10: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0]... (27 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-09-26', '2025-10-03']
âœ… OK: Trovati strike per 2 expiration
  2025-09-26: [1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 9.0, 10.0, 12.0, 17.0, 18.0, 19.0] (21 strike)
  2025-10-03: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 9.0, 10.0, 11.0, 12.0, 15.0, 16.0, 17.0, 20.0] (24 strike)

================================================================================
TESTING: ASST - 5m - sink=influxdb
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 11 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21  45659
2025-11-28  10143
2025-12-05   3908
2025-12-12   1404
2025-12-19  42293

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 20 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-09-19  15405
2025-09-26  20777
2025-10-03  25754
2025-10-10  34681
2025-10-17  50876

Ultime 5 expiration:
expiration  count
2026-03-20  37420
2026-06-18  12294
2026-10-16   9896
2027-01-15  44183
2028-01-21  30841

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-09-26 â†’ 2027-01-15
âœ… OK: Trovate 18 expiration nel range
expiration  count
2025-09-26  20777
2025-10-03  25754
2025-10-10  34681
2025-10-17  50876
2025-10-24  33259
2025-10-31  42527
2025-11-07  19387
2025-11-14  13316
2025-11-21  45659
2025-11-28  10143
2025-12-05   3908
2025-12-12   1404
2025-12-19  42293
2026-01-16  50592
2026-03-20  37420
2026-06-18  12294
2026-10-16   9896
2027-01-15  44183

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 20 expiration (totale 359 strike unici)

Prime 3 expiration con i loro strike:
  2025-09-19: [1.0, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5, 6.0]... (28 strike)
  2025-09-26: [1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5]... (25 strike)
  2025-10-03: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0]... (24 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-09-19', '2025-09-26']
âœ… OK: Trovati strike per 2 expiration
  2025-09-19: [1.0, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 9.0, 10.0, 11.0, 12.0, 12.5, 13.0, 14.0, 15.0, 16.0, 17.0, 17.5, 18.0, 19.0, 20.0] (28 strike)
  2025-09-26: [1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 15.0, 17.0, 18.0, 19.0, 20.0] (25 strike)

================================================================================
TESTING: SPY - tick - sink=influxdb
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 14 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21   5044
2025-11-28    983
2025-12-19   4487
2025-12-31   1919
2026-01-16   7230

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 34 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-08-11 406757
2025-08-12 529058
2025-08-13 152242
2025-08-14  39138
2025-08-15 112981

Ultime 5 expiration:
expiration  count
2026-06-30    529
2026-09-18   1236
2026-12-18    924
2027-01-15    783
2027-12-17    923

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-08-12 â†’ 2027-01-15
âœ… OK: Trovate 32 expiration nel range
expiration  count
2025-08-12 529058
2025-08-13 152242
2025-08-14  39138
2025-08-15 112981
2025-08-18  22868
2025-08-19  11816
2025-08-20   6764
2025-08-21   3986
2025-08-22  23360
2025-08-25   3559
2025-08-26   1266
2025-08-29  24788
2025-09-05  10442
2025-09-12   8149
2025-09-19  30891
2025-09-26   3213
2025-09-30   8978
2025-10-17  13384
2025-10-31   3646
2025-11-21   5044
2025-11-28    983
2025-12-19   4487
2025-12-31   1919
2026-01-16   7230
2026-01-30    526
2026-03-20   3492
2026-03-31    544
2026-06-18   1962
2026-06-30    529
2026-09-18   1236
2026-12-18    924
2027-01-15    783

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 34 expiration (totale 3630 strike unici)

Prime 3 expiration con i loro strike:
  2025-08-11: [400.0, 500.0, 550.0, 570.0, 575.0, 580.0, 585.0, 590.0, 595.0, 600.0]... (68 strike)
  2025-08-12: [400.0, 415.0, 420.0, 480.0, 510.0, 540.0, 550.0, 555.0, 560.0, 565.0]... (78 strike)
  2025-08-13: [400.0, 480.0, 525.0, 530.0, 535.0, 540.0, 545.0, 550.0, 555.0, 560.0]... (79 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-08-11', '2025-08-12']
âœ… OK: Trovati strike per 2 expiration
  2025-08-11: [400.0, 500.0, 550.0, 570.0, 575.0, 580.0, 585.0, 590.0, 595.0, 600.0, 605.0, 608.0, 609.0, 610.0, 611.0, 612.0, 613.0, 614.0, 615.0, 616.0, 617.0, 618.0, 619.0, 620.0, 621.0, 622.0, 623.0, 624.0, 625.0, 626.0, 627.0, 628.0, 629.0, 630.0, 631.0, 632.0, 633.0, 634.0, 635.0, 636.0, 637.0, 638.0, 639.0, 640.0, 641.0, 642.0, 643.0, 644.0, 645.0, 646.0, 647.0, 648.0, 649.0, 650.0, 651.0, 652.0, 653.0, 654.0, 655.0, 657.0, 660.0, 665.0, 670.0, 680.0, 685.0, 695.0, 730.0, 735.0] (68 strike)
  2025-08-12: [400.0, 415.0, 420.0, 480.0, 510.0, 540.0, 550.0, 555.0, 560.0, 565.0, 570.0, 575.0, 580.0, 585.0, 590.0, 595.0, 600.0, 605.0, 608.0, 609.0, 610.0, 611.0, 612.0, 613.0, 614.0, 615.0, 616.0, 617.0, 618.0, 619.0, 620.0, 621.0, 622.0, 623.0, 624.0, 625.0, 626.0, 627.0, 628.0, 629.0, 630.0, 631.0, 632.0, 633.0, 634.0, 635.0, 636.0, 637.0, 638.0, 639.0, 640.0, 641.0, 642.0, 643.0, 644.0, 645.0, 646.0, 647.0, 648.0, 649.0, 650.0, 651.0, 652.0, 653.0, 654.0, 655.0, 656.0, 657.0, 658.0, 659.0, 660.0, 665.0, 675.0, 690.0, 705.0, 725.0, 730.0, 735.0] (78 strike)

================================================================================
TESTING: SPY - 15m - sink=influxdb
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš ï¸  Warnings: ['INFLUXDB_QUERY_ERROR: Error while executing query: gRPC returned resource exhausted error, with message: Error while execution Flight SQL stream: External error: Resources exhausted: Memory Exhausted while Sorting (DiskManager is disabled). gRPC client debug context: UNKNOWN:Error received from peer ipv4:127.0.0.1:8181 {grpc_message:"Error while execution Flight SQL stream: External error: Resources exhausted: Memory Exhausted while Sorting (DiskManager is disabled)", grpc_status:8, created_time:"2025-11-18T11:45:21.2646623+00:00"}. Client context: OK', 'NO_DATA: No data found for the specified symbol, interval, and sink']
â„¹ï¸  Nessuna catena attiva trovata (normale se tutte le expiration sono scadute)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš ï¸  Warnings: ['INFLUXDB_QUERY_ERROR: Error while executing query: gRPC returned resource exhausted error, with message: Error while execution Flight SQL stream: External error: Resources exhausted: Memory Exhausted while Sorting (DiskManager is disabled). gRPC client debug context: UNKNOWN:Error received from peer ipv4:127.0.0.1:8181 {created_time:"2025-11-18T11:45:28.2905208+00:00", grpc_status:8, grpc_message:"Error while execution Flight SQL stream: External error: Resources exhausted: Memory Exhausted while Sorting (DiskManager is disabled)"}. Client context: OK', 'NO_DATA: No data found for the specified symbol, interval, and sink']
âŒ FAIL: Nessuna expiration trovata (inatteso!)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš ï¸  Warnings: ['INFLUXDB_QUERY_ERROR: Error while executing query: gRPC returned resource exhausted error, with message: Error while execution Flight SQL stream: External error: Resources exhausted: Memory Exhausted while Sorting (DiskManager is disabled). gRPC client debug context: UNKNOWN:Error received from peer ipv4:127.0.0.1:8181 {created_time:"2025-11-18T11:45:35.2237719+00:00", grpc_status:8, grpc_message:"Error while execution Flight SQL stream: External error: Resources exhausted: Memory Exhausted while Sorting (DiskManager is disabled)"}. Client context: OK', 'NO_DATA: No data found for the specified symbol, interval, and sink']
âŒ FAIL: Nessun strike trovato

================================================================================
TESTING: SPY - 1d - sink=influxdb
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 18 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21   5129
2025-11-28   8936
2025-12-19   5938
2025-12-31   7538
2026-01-16   5381

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 71 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-08-19    137
2025-08-20    289
2025-08-21    387
2025-08-22    683
2025-08-25    682

Ultime 5 expiration:
expiration  count
2026-09-30   1861
2026-12-18   5729
2027-01-15   6453
2027-12-17   6516
2028-01-21   3284

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-08-20 â†’ 2027-12-17
âœ… OK: Trovate 69 expiration nel range
expiration  count
2025-08-20    289
2025-08-21    387
2025-08-22    683
2025-08-25    682
2025-08-26    805
2025-08-27    913
2025-08-28   1062
2025-08-29   2005
2025-09-02    977
2025-09-03    984
2025-09-04    973
2025-09-05   1909
2025-09-08    605
2025-09-09    566
2025-09-10    878
2025-09-11   1074
2025-09-12   2806
2025-09-15   1417
2025-09-16   1536
2025-09-17   1696
2025-09-18   1948
2025-09-19   5915
2025-09-22   1356
2025-09-23   1028
2025-09-24   1046
2025-09-25   1156
2025-09-26   4628
2025-09-29   1387
2025-09-30   7153
2025-10-01   1612
2025-10-02   1715
2025-10-03   5162
2025-10-06   1495
2025-10-07   1722
2025-10-08   1533
2025-10-09   1257
2025-10-10   5235
2025-10-13   1458
2025-10-14   1576
2025-10-15   1518
2025-10-16   1188
2025-10-17   7679
2025-10-20    824
2025-10-21    693
2025-10-22    569
2025-10-23    503
2025-10-24   4249
2025-10-27    151
2025-10-28     39
2025-10-31  10655
2025-11-07   2017
2025-11-14   1235
2025-11-21   5129
2025-11-28   8936
2025-12-19   5938
2025-12-31   7538
2026-01-16   5381
2026-01-30   5807
2026-02-20   3875
2026-02-27   5232
2026-03-20   5034
2026-03-31   5967
2026-06-18   5308
2026-06-30   6024
2026-09-18   4988
2026-09-30   1861
2026-12-18   5729
2027-01-15   6453
2027-12-17   6516

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 71 expiration (totale 10627 strike unici)

Prime 3 expiration con i loro strike:
  2025-08-19: [400.0, 420.0, 440.0, 460.0, 495.0, 500.0, 530.0, 545.0, 550.0, 555.0]... (80 strike)
  2025-08-20: [400.0, 435.0, 450.0, 480.0, 500.0, 525.0, 530.0, 540.0, 545.0, 550.0]... (95 strike)
  2025-08-21: [400.0, 405.0, 415.0, 420.0, 425.0, 430.0, 435.0, 440.0, 445.0, 450.0]... (127 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-08-19', '2025-08-20']
âœ… OK: Trovati strike per 2 expiration
  2025-08-19: [400.0, 420.0, 440.0, 460.0, 495.0, 500.0, 530.0, 545.0, 550.0, 555.0, 560.0, 565.0, 575.0, 580.0, 585.0, 590.0, 595.0, 600.0, 601.0, 602.0, 603.0, 605.0, 606.0, 607.0, 608.0, 609.0, 610.0, 611.0, 612.0, 613.0, 614.0, 615.0, 616.0, 617.0, 618.0, 619.0, 620.0, 621.0, 622.0, 623.0, 624.0, 625.0, 626.0, 627.0, 628.0, 629.0, 630.0, 631.0, 632.0, 633.0, 634.0, 635.0, 636.0, 637.0, 638.0, 639.0, 640.0, 641.0, 642.0, 643.0, 644.0, 645.0, 646.0, 647.0, 648.0, 649.0, 650.0, 651.0, 652.0, 653.0, 654.0, 655.0, 656.0, 658.0, 659.0, 660.0, 665.0, 675.0, 700.0, 735.0] (80 strike)
  2025-08-20: [400.0, 435.0, 450.0, 480.0, 500.0, 525.0, 530.0, 540.0, 545.0, 550.0, 560.0, 565.0, 570.0, 575.0, 580.0, 585.0, 590.0, 595.0, 596.0, 597.0, 598.0, 599.0, 600.0, 601.0, 602.0, 603.0, 604.0, 605.0, 606.0, 607.0, 608.0, 609.0, 610.0, 611.0, 612.0, 613.0, 614.0, 615.0, 616.0, 617.0, 618.0, 619.0, 620.0, 621.0, 622.0, 623.0, 624.0, 625.0, 626.0, 627.0, 628.0, 629.0, 630.0, 631.0, 632.0, 633.0, 634.0, 635.0, 636.0, 637.0, 638.0, 639.0, 640.0, 641.0, 642.0, 643.0, 644.0, 645.0, 646.0, 647.0, 648.0, 649.0, 650.0, 651.0, 652.0, 653.0, 654.0, 655.0, 656.0, 657.0, 658.0, 659.0, 660.0, 661.0, 663.0, 665.0, 675.0, 685.0, 690.0, 695.0, 705.0, 715.0, 720.0, 730.0, 735.0] (95 strike)

================================================================================
TESTING: TLRY - tick - sink=influxdb
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 12 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21  26753
2025-11-28   2225
2025-12-05    678
2025-12-12    224
2025-12-19  20264

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 25 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-08-22   1374
2025-08-29  11918
2025-09-05   8482
2025-09-12   6494
2025-09-19  13624

Ultime 5 expiration:
expiration  count
2026-01-16  38286
2026-03-20  14028
2026-06-18   1326
2027-01-15  23975
2028-01-21   5906

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-08-29 â†’ 2027-01-15
âœ… OK: Trovate 23 expiration nel range
expiration  count
2025-08-29  11918
2025-09-05   8482
2025-09-12   6494
2025-09-19  13624
2025-09-26   7772
2025-10-03  23594
2025-10-10  31483
2025-10-17  33893
2025-10-24  12349
2025-10-31  16148
2025-11-07   6853
2025-11-14   5280
2025-11-21  26753
2025-11-28   2225
2025-12-05    678
2025-12-12    224
2025-12-19  20264
2025-12-26    201
2026-01-02     14
2026-01-16  38286
2026-03-20  14028
2026-06-18   1326
2027-01-15  23975

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 25 expiration (totale 204 strike unici)

Prime 3 expiration con i loro strike:
  2025-08-22: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-08-29: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-09-05: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-08-22', '2025-08-29']
âœ… OK: Trovati strike per 2 expiration
  2025-08-22: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-08-29: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

================================================================================
TESTING: TLRY - 5m - sink=influxdb
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 11 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21  38355
2025-11-28  18439
2025-12-05   7281
2025-12-12   3301
2025-12-19  50759

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 22 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-09-05    711
2025-09-12   4997
2025-09-19   9157
2025-09-26  12764
2025-10-03  17165

Ultime 5 expiration:
expiration  count
2026-01-16  65284
2026-03-20  50128
2026-06-18  10465
2027-01-15  48691
2028-01-21  37715

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-09-12 â†’ 2027-01-15
âœ… OK: Trovate 20 expiration nel range
expiration  count
2025-09-12   4997
2025-09-19   9157
2025-09-26  12764
2025-10-03  17165
2025-10-10  21889
2025-10-17  33318
2025-10-24  29339
2025-10-31  31107
2025-11-07  29657
2025-11-14  25638
2025-11-21  38355
2025-11-28  18439
2025-12-05   7281
2025-12-12   3301
2025-12-19  50759
2025-12-26    793
2026-01-16  65284
2026-03-20  50128
2026-06-18  10465
2027-01-15  48691

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 22 expiration (totale 188 strike unici)

Prime 3 expiration con i loro strike:
  2025-09-05: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-09-12: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-09-19: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-09-05', '2025-09-12']
âœ… OK: Trovati strike per 2 expiration
  2025-09-05: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-09-12: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

================================================================================
TESTING: TLRY - 1d - sink=influxdb
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 12 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21    439
2025-11-28    247
2025-12-05    101
2025-12-12     58
2025-12-19    648

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 25 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-08-22     23
2025-08-29     68
2025-09-05    100
2025-09-12    132
2025-09-19    176

Ultime 5 expiration:
expiration  count
2026-01-16    865
2026-03-20    646
2026-06-18    144
2027-01-15    632
2028-01-21    436

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-08-29 â†’ 2027-01-15
âœ… OK: Trovate 23 expiration nel range
expiration  count
2025-08-29     68
2025-09-05    100
2025-09-12    132
2025-09-19    176
2025-09-26    197
2025-10-03    218
2025-10-10    257
2025-10-17    415
2025-10-24    281
2025-10-31    285
2025-11-07    278
2025-11-14    278
2025-11-21    439
2025-11-28    247
2025-12-05    101
2025-12-12     58
2025-12-19    648
2025-12-26     40
2026-01-02      6
2026-01-16    865
2026-03-20    646
2026-06-18    144
2027-01-15    632

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 25 expiration (totale 204 strike unici)

Prime 3 expiration con i loro strike:
  2025-08-22: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-08-29: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-09-05: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-08-22', '2025-08-29']
âœ… OK: Trovati strike per 2 expiration
  2025-08-22: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-08-29: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

================================================================================
TESTING: TLRY - tick - sink=parquet
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 6 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21     84
2025-12-19    476
2026-01-16    607
2026-03-20    124
2027-01-15    266

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 12 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-09-26    693
2025-10-03    511
2025-10-10    340
2025-10-17    646
2025-10-24    189

Ultime 5 expiration:
expiration  count
2025-12-19    476
2026-01-16    607
2026-03-20    124
2027-01-15    266
2028-01-21    104

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-10-03 â†’ 2027-01-15
âœ… OK: Trovate 10 expiration nel range
expiration  count
2025-10-03    511
2025-10-10    340
2025-10-17    646
2025-10-24    189
2025-10-31     75
2025-11-21     84
2025-12-19    476
2026-01-16    607
2026-03-20    124
2027-01-15    266

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 12 expiration (totale 80 strike unici)

Prime 3 expiration con i loro strike:
  2025-09-26: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-10-03: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-10-10: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-09-26', '2025-10-03']
âœ… OK: Trovati strike per 2 expiration
  2025-09-26: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-10-03: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

================================================================================
TESTING: TLRY - 1d - sink=parquet
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 1: Expiration Chains (existing_chain=True)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 12 catene di expiration attive

Prime 5 expiration:
expiration  count
2025-11-21    826
2025-11-28    464
2025-12-05    190
2025-12-12    110
2025-12-19   1124

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 2: Expiration Chains (existing_chain=False - tutte storiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovate 25 catene di expiration totali (storiche + attive)

Prime 5 expiration:
expiration  count
2025-08-22     12
2025-08-29     72
2025-09-05    120
2025-09-12    176
2025-09-19    230

Ultime 5 expiration:
expiration  count
2026-01-16   1468
2026-03-20   1124
2026-06-18    252
2027-01-15   1086
2028-01-21    812

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 3: Expiration Chains (range di date specifico)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Range testato: 2025-08-29 â†’ 2027-01-15
âœ… OK: Trovate 23 expiration nel range
expiration  count
2025-08-29     72
2025-09-05    120
2025-09-12    176
2025-09-19    230
2025-09-26    296
2025-10-03    354
2025-10-10    392
2025-10-17    642
2025-10-24    490
2025-10-31    512
2025-11-07    520
2025-11-14    532
2025-11-21    826
2025-11-28    464
2025-12-05    190
2025-12-12    110
2025-12-19   1124
2025-12-26     60
2026-01-02     10
2026-01-16   1468
2026-03-20   1124
2026-06-18    252
2027-01-15   1086

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 4: Strikes per Expiration (tutte)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… OK: Trovati strike per 25 expiration (totale 205 strike unici)

Prime 3 expiration con i loro strike:
  2025-08-22: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-08-29: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-09-05: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TEST 5: Strikes per Expiration (specifiche)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Expiration selezionate: ['2025-08-22', '2025-08-29']
âœ… OK: Trovati strike per 2 expiration
  2025-08-22: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)
  2025-08-29: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0] (6 strike)

################################################################################
# SUMMARY - ALL TESTS
################################################################################

            Series              Test Status  Count
     TLRY-tick-csv exp_chains_active   PASS     11
     TLRY-tick-csv    exp_chains_all   PASS     13
     TLRY-tick-csv  exp_chains_range   PASS     11
     TLRY-tick-csv       strikes_all   PASS    109
     TLRY-tick-csv  strikes_specific   PASS     15
       TLRY-5m-csv exp_chains_active   PASS     11
       TLRY-5m-csv    exp_chains_all   PASS     13
       TLRY-5m-csv  exp_chains_range   PASS     11
       TLRY-5m-csv       strikes_all   PASS    104
       TLRY-5m-csv  strikes_specific   PASS     14
       TLRY-1d-csv exp_chains_active   PASS     12
       TLRY-1d-csv    exp_chains_all   PASS     25
       TLRY-1d-csv  exp_chains_range   PASS     23
       TLRY-1d-csv       strikes_all   PASS    205
       TLRY-1d-csv  strikes_specific   PASS     12
ASST-tick-influxdb exp_chains_active   PASS     11
ASST-tick-influxdb    exp_chains_all   PASS     19
ASST-tick-influxdb  exp_chains_range   PASS     17
ASST-tick-influxdb       strikes_all   PASS    325
ASST-tick-influxdb  strikes_specific   PASS     45
  ASST-5m-influxdb exp_chains_active   PASS     11
  ASST-5m-influxdb    exp_chains_all   PASS     20
  ASST-5m-influxdb  exp_chains_range   PASS     18
  ASST-5m-influxdb       strikes_all   PASS    359
  ASST-5m-influxdb  strikes_specific   PASS     53
 SPY-tick-influxdb exp_chains_active   PASS     14
 SPY-tick-influxdb    exp_chains_all   PASS     34
 SPY-tick-influxdb  exp_chains_range   PASS     32
 SPY-tick-influxdb       strikes_all   PASS   3630
 SPY-tick-influxdb  strikes_specific   PASS    146
  SPY-15m-influxdb exp_chains_active  EMPTY      0
  SPY-15m-influxdb    exp_chains_all   FAIL      0
  SPY-15m-influxdb       strikes_all   FAIL      0
   SPY-1d-influxdb exp_chains_active   PASS     18
   SPY-1d-influxdb    exp_chains_all   PASS     71
   SPY-1d-influxdb  exp_chains_range   PASS     69
   SPY-1d-influxdb       strikes_all   PASS  10627
   SPY-1d-influxdb  strikes_specific   PASS    175
TLRY-tick-influxdb exp_chains_active   PASS     12
TLRY-tick-influxdb    exp_chains_all   PASS     25
TLRY-tick-influxdb  exp_chains_range   PASS     23
TLRY-tick-influxdb       strikes_all   PASS    204
TLRY-tick-influxdb  strikes_specific   PASS     12
  TLRY-5m-influxdb exp_chains_active   PASS     11
  TLRY-5m-influxdb    exp_chains_all   PASS     22
  TLRY-5m-influxdb  exp_chains_range   PASS     20
  TLRY-5m-influxdb       strikes_all   PASS    188
  TLRY-5m-influxdb  strikes_specific   PASS     12
  TLRY-1d-influxdb exp_chains_active   PASS     12
  TLRY-1d-influxdb    exp_chains_all   PASS     25
  TLRY-1d-influxdb  exp_chains_range   PASS     23
  TLRY-1d-influxdb       strikes_all   PASS    204
  TLRY-1d-influxdb  strikes_specific   PASS     12
 TLRY-tick-parquet exp_chains_active   PASS      6
 TLRY-tick-parquet    exp_chains_all   PASS     12
 TLRY-tick-parquet  exp_chains_range   PASS     10
 TLRY-tick-parquet       strikes_all   PASS     80
 TLRY-tick-parquet  strikes_specific   PASS     12
   TLRY-1d-parquet exp_chains_active   PASS     12
   TLRY-1d-parquet    exp_chains_all   PASS     25
   TLRY-1d-parquet  exp_chains_range   PASS     23
   TLRY-1d-parquet       strikes_all   PASS    205
   TLRY-1d-parquet  strikes_specific   PASS     12

================================================================================
Total tests: 63
âœ… Passed: 60
âŒ Failed: 2
â„¹ï¸  Empty (no data in range): 1
Success rate: 95.2%

test sulle query del manager

================================================================================
COMPREHENSIVE QUERY TESTS - ALL INTERVALS, ALL SINKS
================================================================================

ğŸ“Š Scansione dati disponibili...
âœ… Trovate 13 serie di dati

ğŸ“ˆ Dati disponibili per intervallo:
   â€¢ Tick: 5 serie
   â€¢ Minuti (1m-1h): 4 serie
   â€¢ 1d: 4 serie

################################################################################
# TESTING INTERVAL: TICK
################################################################################

================================================================================
SERIE: TLRY (option) - tick - sink=csv
================================================================================
ğŸ“… Range completo: 2025-11-06 â†’ 2025-11-11 (5 giorni)
ğŸ“… start_date usato: 2025-11-07 (day+1 dal primo)
ğŸ“… end_date usato: 2025-11-10 (day-1 dall'ultimo)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 1: SOLO start_date = 2025-11-07
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 1: start_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche dalla start_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-07 09:30:00.922000
   Ultima riga timestamp: 2025-11-07 09:30:01.290000
   Span temporale: 0 days 00:00:00.368000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 2: start_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche (piÃ¹ recenti da TUTTI i dati)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-11 11:14:35.948000
   Ultima riga timestamp: 2025-11-11 11:15:12.939000
   Span temporale: 0 days 00:00:36.991000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 3: start_date + get_first_n_days=1
Comportamento atteso: Primo giorno dalla start_date
================================================================================
âœ… OK: 2626 righe restituite
   Prima riga timestamp: 2025-11-07 09:30:00.922000
   Ultima riga timestamp: 2025-11-07 15:59:59.248000
   Span temporale: 0 days 06:29:58.326000
   Timestamp unici: 1678 su 2626 righe

================================================================================
TEST 4: start_date + get_first_n_minutes=5
Comportamento atteso: Primi 5 minuti dalla start_date
================================================================================
âœ… OK: 78 righe restituite
   Prima riga timestamp: 2025-11-07 09:30:00.922000
   Ultima riga timestamp: 2025-11-07 09:34:34.295000
   Span temporale: 0 days 00:04:33.373000
   Timestamp unici: 61 su 78 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 2: SOLO end_date = 2025-11-10
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 5: end_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-06 09:30:00.160000
   Ultima riga timestamp: 2025-11-06 09:30:01.351000
   Span temporale: 0 days 00:00:01.191000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 6: end_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-10 15:59:36.378000
   Ultima riga timestamp: 2025-11-10 15:59:57.311000
   Span temporale: 0 days 00:00:20.933000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 7: end_date + get_last_n_days=1
Comportamento atteso: Ultimo giorno fino alla end_date
================================================================================
âœ… OK: 3188 righe restituite
   Prima riga timestamp: 2025-11-10 09:30:00.053000
   Ultima riga timestamp: 2025-11-10 15:59:57.311000
   Span temporale: 0 days 06:29:57.258000
   Timestamp unici: 2051 su 3188 righe

================================================================================
TEST 8: end_date + get_last_n_minutes=5
Comportamento atteso: Ultimi 5 minuti fino alla end_date
================================================================================
âœ… OK: 39 righe restituite
   Prima riga timestamp: 2025-11-10 15:55:07.855000
   Ultima riga timestamp: 2025-11-10 15:59:57.311000
   Span temporale: 0 days 00:04:49.456000
   Timestamp unici: 31 su 39 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 3: start_date=2025-11-07 + end_date=2025-11-10
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 9: start + end + get_first_n_rows=10
Comportamento atteso: Prime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-11-07 09:30:00.922000
   Ultima riga timestamp: 2025-11-07 09:30:01.781000
   Span temporale: 0 days 00:00:00.859000
   Timestamp unici: 9 su 10 righe

================================================================================
TEST 10: start + end + get_last_n_rows=10
Comportamento atteso: Ultime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-11-10 15:59:07.253000
   Ultima riga timestamp: 2025-11-10 15:59:57.311000
   Span temporale: 0 days 00:00:50.058000
   Timestamp unici: 9 su 10 righe

================================================================================
TEST 11: start + end + get_first_n_days=1
Comportamento atteso: Primo giorno nel range start-end
================================================================================
âœ… OK: 2626 righe restituite
   Prima riga timestamp: 2025-11-07 09:30:00.922000
   Ultima riga timestamp: 2025-11-07 15:59:59.248000
   Span temporale: 0 days 06:29:58.326000
   Timestamp unici: 1678 su 2626 righe

ğŸ” DEBUG TEST 12: Investigating start + end + get_last_n_days=1

================================================================================
TEST 12: start + end + get_last_n_days=1
Comportamento atteso: Ultimo giorno nel range start-end
================================================================================
âœ… OK: 3188 righe restituite
   Prima riga timestamp: 2025-11-10 09:30:00.053000
   Ultima riga timestamp: 2025-11-10 15:59:57.311000
   Span temporale: 0 days 06:29:57.258000
   Timestamp unici: 2051 su 3188 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 4: NESSUNA data (default)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 13: no dates + get_first_n_rows=5
Comportamento atteso: Prime 5 righe di TUTTI i dati
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-06 09:30:00.160000
   Ultima riga timestamp: 2025-11-06 09:30:01.351000
   Span temporale: 0 days 00:00:01.191000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 14: no dates + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe di TUTTI i dati (piÃ¹ recenti)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-11 11:14:35.948000
   Ultima riga timestamp: 2025-11-11 11:15:12.939000
   Span temporale: 0 days 00:00:36.991000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 15: no dates + get_first_n_days=1
Comportamento atteso: Primo giorno di TUTTI i dati
================================================================================
âœ… OK: 1721 righe restituite
   Prima riga timestamp: 2025-11-06 09:30:00.160000
   Ultima riga timestamp: 2025-11-06 15:59:57.417000
   Span temporale: 0 days 06:29:57.257000
   Timestamp unici: 1143 su 1721 righe

================================================================================
TEST 16: no dates + get_last_n_days=1
Comportamento atteso: Ultimo giorno di TUTTI i dati (piÃ¹ recente)
================================================================================
âœ… OK: 490 righe restituite
   Prima riga timestamp: 2025-11-11 09:30:00.734000
   Ultima riga timestamp: 2025-11-11 11:15:12.939000
   Span temporale: 0 days 01:45:12.205000
   Timestamp unici: 358 su 490 righe

================================================================================
SERIE: TLRY (option) - tick - sink=parquet
================================================================================
ğŸ“… Range completo: 2025-09-22 â†’ 2025-09-22 (0 giorni)
ğŸ“… start_date usato: 2025-09-22 (day+1 dal primo)
ğŸ“… end_date usato: 2025-09-22 (day-1 dall'ultimo)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 1: SOLO start_date = 2025-09-22
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 1: start_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche dalla start_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-22 09:30:00.522000
   Ultima riga timestamp: 2025-09-22 09:30:00.803000
   Span temporale: 0 days 00:00:00.281000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 2: start_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche (piÃ¹ recenti da TUTTI i dati)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-22 15:59:33.237000
   Ultima riga timestamp: 2025-09-22 15:59:59.887000
   Span temporale: 0 days 00:00:26.650000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 3: start_date + get_first_n_days=1
Comportamento atteso: Primo giorno dalla start_date
================================================================================
âœ… OK: 4115 righe restituite
   Prima riga timestamp: 2025-09-22 09:30:00.522000
   Ultima riga timestamp: 2025-09-22 15:59:59.887000
   Span temporale: 0 days 06:29:59.365000
   Timestamp unici: 2693 su 4115 righe

================================================================================
TEST 4: start_date + get_first_n_minutes=5
Comportamento atteso: Primi 5 minuti dalla start_date
================================================================================
âœ… OK: 354 righe restituite
   Prima riga timestamp: 2025-09-22 09:30:00.522000
   Ultima riga timestamp: 2025-09-22 09:34:57.170000
   Span temporale: 0 days 00:04:56.648000
   Timestamp unici: 210 su 354 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 2: SOLO end_date = 2025-09-22
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 5: end_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-22 09:30:00.522000
   Ultima riga timestamp: 2025-09-22 09:30:00.803000
   Span temporale: 0 days 00:00:00.281000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 6: end_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-22 15:59:33.237000
   Ultima riga timestamp: 2025-09-22 15:59:59.887000
   Span temporale: 0 days 00:00:26.650000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 7: end_date + get_last_n_days=1
Comportamento atteso: Ultimo giorno fino alla end_date
================================================================================
âœ… OK: 4115 righe restituite
   Prima riga timestamp: 2025-09-22 09:30:00.522000
   Ultima riga timestamp: 2025-09-22 15:59:59.887000
   Span temporale: 0 days 06:29:59.365000
   Timestamp unici: 2693 su 4115 righe

================================================================================
TEST 8: end_date + get_last_n_minutes=5
Comportamento atteso: Ultimi 5 minuti fino alla end_date
================================================================================
âœ… OK: 56 righe restituite
   Prima riga timestamp: 2025-09-22 15:55:10.685000
   Ultima riga timestamp: 2025-09-22 15:59:59.887000
   Span temporale: 0 days 00:04:49.202000
   Timestamp unici: 36 su 56 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 4: NESSUNA data (default)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 9: no dates + get_first_n_rows=5
Comportamento atteso: Prime 5 righe di TUTTI i dati
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-22 09:30:00.522000
   Ultima riga timestamp: 2025-09-22 09:30:00.803000
   Span temporale: 0 days 00:00:00.281000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 10: no dates + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe di TUTTI i dati (piÃ¹ recenti)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-22 15:59:33.237000
   Ultima riga timestamp: 2025-09-22 15:59:59.887000
   Span temporale: 0 days 00:00:26.650000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 11: no dates + get_first_n_days=1
Comportamento atteso: Primo giorno di TUTTI i dati
================================================================================
âœ… OK: 4115 righe restituite
   Prima riga timestamp: 2025-09-22 09:30:00.522000
   Ultima riga timestamp: 2025-09-22 15:59:59.887000
   Span temporale: 0 days 06:29:59.365000
   Timestamp unici: 2693 su 4115 righe

================================================================================
TEST 12: no dates + get_last_n_days=1
Comportamento atteso: Ultimo giorno di TUTTI i dati (piÃ¹ recente)
================================================================================
âœ… OK: 4115 righe restituite
   Prima riga timestamp: 2025-09-22 09:30:00.522000
   Ultima riga timestamp: 2025-09-22 15:59:59.887000
   Span temporale: 0 days 06:29:59.365000
   Timestamp unici: 2693 su 4115 righe

================================================================================
SERIE: ASST (option) - tick - sink=influxdb
================================================================================
ğŸ“… Range completo: 2025-09-22 â†’ 2025-10-31 (39 giorni)
ğŸ“… start_date usato: 2025-09-23 (day+1 dal primo)
ğŸ“… end_date usato: 2025-10-30 (day-1 dall'ultimo)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 1: SOLO start_date = 2025-09-23
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 1: start_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche dalla start_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-23 13:30:00.630000
   Ultima riga timestamp: 2025-09-23 13:30:04.635000
   Span temporale: 0 days 00:00:04.005000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 2: start_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche (piÃ¹ recenti da TUTTI i dati)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-10-31 19:59:58.151000
   Ultima riga timestamp: 2025-10-31 19:59:58.493000
   Span temporale: 0 days 00:00:00.342000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 3: start_date + get_first_n_days=1
Comportamento atteso: Primo giorno dalla start_date
================================================================================
âœ… OK: 5779 righe restituite
   Prima riga timestamp: 2025-09-23 13:30:00.630000
   Ultima riga timestamp: 2025-09-23 19:59:54.437000
   Span temporale: 0 days 06:29:53.807000
   Timestamp unici: 5055 su 5779 righe

================================================================================
TEST 4: start_date + get_first_n_minutes=5
Comportamento atteso: Primi 5 minuti dalla start_date
================================================================================
âœ… OK: 301 righe restituite
   Prima riga timestamp: 2025-09-23 13:30:00.630000
   Ultima riga timestamp: 2025-09-23 13:34:58.583000
   Span temporale: 0 days 00:04:57.953000
   Timestamp unici: 272 su 301 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 2: SOLO end_date = 2025-10-30
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 5: end_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-22 13:30:02.031000
   Ultima riga timestamp: 2025-09-22 13:30:03.889000
   Span temporale: 0 days 00:00:01.858000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 6: end_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-10-30 19:59:57.222000
   Ultima riga timestamp: 2025-10-30 19:59:59.530000
   Span temporale: 0 days 00:00:02.308000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 7: end_date + get_last_n_days=1
Comportamento atteso: Ultimo giorno fino alla end_date
================================================================================
âœ… OK: 14550 righe restituite
   Prima riga timestamp: 2025-10-30 13:30:00.351000
   Ultima riga timestamp: 2025-10-30 19:59:59.530000
   Span temporale: 0 days 06:29:59.179000
   Timestamp unici: 14034 su 14550 righe

================================================================================
TEST 8: end_date + get_last_n_minutes=5
Comportamento atteso: Ultimi 5 minuti fino alla end_date
================================================================================
âœ… OK: 165 righe restituite
   Prima riga timestamp: 2025-10-30 19:55:01.818000
   Ultima riga timestamp: 2025-10-30 19:59:59.530000
   Span temporale: 0 days 00:04:57.712000
   Timestamp unici: 159 su 165 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 3: start_date=2025-09-23 + end_date=2025-10-30
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 9: start + end + get_first_n_rows=10
Comportamento atteso: Prime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-09-23 13:30:00.630000
   Ultima riga timestamp: 2025-09-23 13:30:08.986000
   Span temporale: 0 days 00:00:08.356000
   Timestamp unici: 8 su 10 righe

================================================================================
TEST 10: start + end + get_last_n_rows=10
Comportamento atteso: Ultime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-10-30 19:59:52.281000
   Ultima riga timestamp: 2025-10-30 19:59:59.530000
   Span temporale: 0 days 00:00:07.249000
   Timestamp unici: 10 su 10 righe

================================================================================
TEST 11: start + end + get_first_n_days=1
Comportamento atteso: Primo giorno nel range start-end
================================================================================
âœ… OK: 5779 righe restituite
   Prima riga timestamp: 2025-09-23 13:30:00.630000
   Ultima riga timestamp: 2025-09-23 19:59:54.437000
   Span temporale: 0 days 06:29:53.807000
   Timestamp unici: 5055 su 5779 righe

ğŸ” DEBUG TEST 12: Investigating start + end + get_last_n_days=1

================================================================================
TEST 12: start + end + get_last_n_days=1
Comportamento atteso: Ultimo giorno nel range start-end
================================================================================
âœ… OK: 14550 righe restituite
   Prima riga timestamp: 2025-10-30 13:30:00.351000
   Ultima riga timestamp: 2025-10-30 19:59:59.530000
   Span temporale: 0 days 06:29:59.179000
   Timestamp unici: 14034 su 14550 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 4: NESSUNA data (default)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 13: no dates + get_first_n_rows=5
Comportamento atteso: Prime 5 righe di TUTTI i dati
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-22 13:30:02.031000
   Ultima riga timestamp: 2025-09-22 13:30:03.889000
   Span temporale: 0 days 00:00:01.858000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 14: no dates + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe di TUTTI i dati (piÃ¹ recenti)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-10-31 19:59:58.151000
   Ultima riga timestamp: 2025-10-31 19:59:58.493000
   Span temporale: 0 days 00:00:00.342000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 15: no dates + get_first_n_days=1
Comportamento atteso: Primo giorno di TUTTI i dati
================================================================================
âœ… OK: 5142 righe restituite
   Prima riga timestamp: 2025-09-22 13:30:02.031000
   Ultima riga timestamp: 2025-09-22 19:59:57.980000
   Span temporale: 0 days 06:29:55.949000
   Timestamp unici: 4648 su 5142 righe

================================================================================
TEST 16: no dates + get_last_n_days=1
Comportamento atteso: Ultimo giorno di TUTTI i dati (piÃ¹ recente)
================================================================================
âœ… OK: 12698 righe restituite
   Prima riga timestamp: 2025-10-31 13:30:00.612000
   Ultima riga timestamp: 2025-10-31 19:59:58.493000
   Span temporale: 0 days 06:29:57.881000
   Timestamp unici: 12272 su 12698 righe

################################################################################
# TESTING INTERVAL: MINUTES
################################################################################

================================================================================
SERIE: TLRY (option) - 5m - sink=csv
================================================================================
ğŸ“… Range completo: 2025-11-06 â†’ 2025-11-07 (1 giorni)
ğŸ“… start_date usato: 2025-11-06 (day+1 dal primo)
ğŸ“… end_date usato: 2025-11-07 (day-1 dall'ultimo)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 1: SOLO start_date = 2025-11-06
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 1: start_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche dalla start_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-06 09:30:00.000000
   Ultima riga timestamp: 2025-11-06 09:30:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 2: start_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche (piÃ¹ recenti da TUTTI i dati)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-07 16:00:00.000000
   Ultima riga timestamp: 2025-11-07 16:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 3: start_date + get_first_n_days=1
Comportamento atteso: Primo giorno dalla start_date
================================================================================
âœ… OK: 9563 righe restituite
   Prima riga timestamp: 2025-11-06 09:30:00.000000
   Ultima riga timestamp: 2025-11-06 16:00:00.000000
   Span temporale: 0 days 06:30:00
   Timestamp unici: 79 su 9563 righe

================================================================================
TEST 4: start_date + get_first_n_minutes=5
Comportamento atteso: Primi 5 minuti dalla start_date
================================================================================
âœ… OK: 246 righe restituite
   Prima riga timestamp: 2025-11-06 09:30:00.000000
   Ultima riga timestamp: 2025-11-06 09:35:00.000000
   Span temporale: 0 days 00:05:00
   Timestamp unici: 2 su 246 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 2: SOLO end_date = 2025-11-07
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 5: end_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-06 09:30:00.000000
   Ultima riga timestamp: 2025-11-06 09:30:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 6: end_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-07 16:00:00.000000
   Ultima riga timestamp: 2025-11-07 16:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 7: end_date + get_last_n_days=1
Comportamento atteso: Ultimo giorno fino alla end_date
================================================================================
âœ… OK: 11464 righe restituite
   Prima riga timestamp: 2025-11-07 09:30:00.000000
   Ultima riga timestamp: 2025-11-07 16:00:00.000000
   Span temporale: 0 days 06:30:00
   Timestamp unici: 79 su 11464 righe

================================================================================
TEST 8: end_date + get_last_n_minutes=5
Comportamento atteso: Ultimi 5 minuti fino alla end_date
================================================================================
âœ… OK: 290 righe restituite
   Prima riga timestamp: 2025-11-07 15:55:00.000000
   Ultima riga timestamp: 2025-11-07 16:00:00.000000
   Span temporale: 0 days 00:05:00
   Timestamp unici: 2 su 290 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 4: NESSUNA data (default)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 9: no dates + get_first_n_rows=5
Comportamento atteso: Prime 5 righe di TUTTI i dati
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-06 09:30:00.000000
   Ultima riga timestamp: 2025-11-06 09:30:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 10: no dates + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe di TUTTI i dati (piÃ¹ recenti)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-07 16:00:00.000000
   Ultima riga timestamp: 2025-11-07 16:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 11: no dates + get_first_n_days=1
Comportamento atteso: Primo giorno di TUTTI i dati
================================================================================
âœ… OK: 9563 righe restituite
   Prima riga timestamp: 2025-11-06 09:30:00.000000
   Ultima riga timestamp: 2025-11-06 16:00:00.000000
   Span temporale: 0 days 06:30:00
   Timestamp unici: 79 su 9563 righe

================================================================================
TEST 12: no dates + get_last_n_days=1
Comportamento atteso: Ultimo giorno di TUTTI i dati (piÃ¹ recente)
================================================================================
âœ… OK: 11464 righe restituite
   Prima riga timestamp: 2025-11-07 09:30:00.000000
   Ultima riga timestamp: 2025-11-07 16:00:00.000000
   Span temporale: 0 days 06:30:00
   Timestamp unici: 79 su 11464 righe

âš ï¸  Nessun dato MINUTES su sink=parquet, salto...

================================================================================
SERIE: ASST (option) - 5m - sink=influxdb
================================================================================
ğŸ“… Range completo: 2025-09-15 â†’ 2025-11-04 (50 giorni)
ğŸ“… start_date usato: 2025-09-16 (day+1 dal primo)
ğŸ“… end_date usato: 2025-11-03 (day-1 dall'ultimo)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 1: SOLO start_date = 2025-09-16
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 1: start_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche dalla start_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-16 13:30:00.000000
   Ultima riga timestamp: 2025-09-16 13:30:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 2: start_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche (piÃ¹ recenti da TUTTI i dati)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-04 20:57:00.000000
   Ultima riga timestamp: 2025-11-04 20:57:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 3: start_date + get_first_n_days=1
Comportamento atteso: Primo giorno dalla start_date
================================================================================
âœ… OK: 16985 righe restituite
   Prima riga timestamp: 2025-09-16 13:30:00.000000
   Ultima riga timestamp: 2025-09-16 20:00:00.000000
   Span temporale: 0 days 06:30:00
   Timestamp unici: 79 su 16985 righe

================================================================================
TEST 4: start_date + get_first_n_minutes=5
Comportamento atteso: Primi 5 minuti dalla start_date
================================================================================
âœ… OK: 430 righe restituite
   Prima riga timestamp: 2025-09-16 13:30:00.000000
   Ultima riga timestamp: 2025-09-16 13:35:00.000000
   Span temporale: 0 days 00:05:00
   Timestamp unici: 2 su 430 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 2: SOLO end_date = 2025-11-03
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 5: end_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-15 13:30:00.000000
   Ultima riga timestamp: 2025-09-15 13:30:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 6: end_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-10-31 20:00:00.000000
   Ultima riga timestamp: 2025-10-31 20:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 7: end_date + get_last_n_days=1
Comportamento atteso: Ultimo giorno fino alla end_date
================================================================================
âŒ FAIL: Nessun dato restituito

================================================================================
TEST 8: end_date + get_last_n_minutes=5
Comportamento atteso: Ultimi 5 minuti fino alla end_date
================================================================================
âœ… OK: 660 righe restituite
   Prima riga timestamp: 2025-10-31 19:55:00.000000
   Ultima riga timestamp: 2025-10-31 20:00:00.000000
   Span temporale: 0 days 00:05:00
   Timestamp unici: 3 su 660 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 3: start_date=2025-09-16 + end_date=2025-11-03
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 9: start + end + get_first_n_rows=10
Comportamento atteso: Prime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-09-16 13:30:00.000000
   Ultima riga timestamp: 2025-09-16 13:30:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 10 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 10: start + end + get_last_n_rows=10
Comportamento atteso: Ultime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-10-31 20:00:00.000000
   Ultima riga timestamp: 2025-10-31 20:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 10 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 11: start + end + get_first_n_days=1
Comportamento atteso: Primo giorno nel range start-end
================================================================================
âœ… OK: 16985 righe restituite
   Prima riga timestamp: 2025-09-16 13:30:00.000000
   Ultima riga timestamp: 2025-09-16 20:00:00.000000
   Span temporale: 0 days 06:30:00
   Timestamp unici: 79 su 16985 righe

ğŸ” DEBUG TEST 12: Investigating start + end + get_last_n_days=1

================================================================================
TEST 12: start + end + get_last_n_days=1
Comportamento atteso: Ultimo giorno nel range start-end
================================================================================
âŒ FAIL: Nessun dato restituito
   ğŸ” Questo era il TEST 12 che falliva - investigare!

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 4: NESSUNA data (default)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 13: no dates + get_first_n_rows=5
Comportamento atteso: Prime 5 righe di TUTTI i dati
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-09-15 13:30:00.000000
   Ultima riga timestamp: 2025-09-15 13:30:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 14: no dates + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe di TUTTI i dati (piÃ¹ recenti)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-04 20:57:00.000000
   Ultima riga timestamp: 2025-11-04 20:57:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 15: no dates + get_first_n_days=1
Comportamento atteso: Primo giorno di TUTTI i dati
================================================================================
âœ… OK: 16195 righe restituite
   Prima riga timestamp: 2025-09-15 13:30:00.000000
   Ultima riga timestamp: 2025-09-15 20:00:00.000000
   Span temporale: 0 days 06:30:00
   Timestamp unici: 79 su 16195 righe

================================================================================
TEST 16: no dates + get_last_n_days=1
Comportamento atteso: Ultimo giorno di TUTTI i dati (piÃ¹ recente)
================================================================================
âœ… OK: 20230 righe restituite
   Prima riga timestamp: 2025-11-04 14:30:00.000000
   Ultima riga timestamp: 2025-11-04 20:57:00.000000
   Span temporale: 0 days 06:27:00
   Timestamp unici: 82 su 20230 righe

################################################################################
# TESTING INTERVAL: DAILY (1d)
################################################################################

================================================================================
SERIE: TLRY (option) - 1d - sink=csv
================================================================================
ğŸ“… Range completo: 2025-08-21 â†’ 2025-11-13 (84 giorni)
ğŸ“… start_date usato: 2025-08-22 (day+1 dal primo)
ğŸ“… end_date usato: 2025-11-12 (day-1 dall'ultimo)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 1: SOLO start_date = 2025-08-22
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 1: start_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche dalla start_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-08-22 00:00:00.000000
   Ultima riga timestamp: 2025-08-22 00:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 2: start_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche (piÃ¹ recenti da TUTTI i dati)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-13 15:59:03.701000
   Ultima riga timestamp: 2025-11-13 15:59:50.889000
   Span temporale: 0 days 00:00:47.188000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 3: start_date + get_first_n_days=1
Comportamento atteso: Primo giorno dalla start_date
================================================================================
âœ… OK: 134 righe restituite
   Prima riga timestamp: 2025-08-22 00:00:00.000000
   Ultima riga timestamp: 2025-08-22 15:59:56.176000
   Span temporale: 0 days 15:59:56.176000
   Timestamp unici: 104 su 134 righe

================================================================================
TEST 4: start_date + get_first_n_minutes=5 (1d - should be rejected)
Comportamento atteso: Parametro invalido - warning INVALID_MINUTES_PARAM
================================================================================
âš ï¸  Warnings: ["INVALID_MINUTES_PARAM: get_first_n_minutes and get_last_n_minutes cannot be used with interval='1d'. Use get_first_n_days or get_last_n_days instead."]
âœ… OK: Parametro invalido correttamente rifiutato

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 2: SOLO end_date = 2025-11-12
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 5: end_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-08-21 00:00:00.000000
   Ultima riga timestamp: 2025-08-21 00:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 6: end_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-12 15:59:10.666000
   Ultima riga timestamp: 2025-11-12 15:59:41.887000
   Span temporale: 0 days 00:00:31.221000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 7: end_date + get_last_n_days=1
Comportamento atteso: Ultimo giorno fino alla end_date
================================================================================
âœ… OK: 222 righe restituite
   Prima riga timestamp: 2025-11-12 00:00:00.000000
   Ultima riga timestamp: 2025-11-12 15:59:41.887000
   Span temporale: 0 days 15:59:41.887000
   Timestamp unici: 108 su 222 righe

================================================================================
TEST 8: end_date + get_last_n_minutes=5 (1d - should be rejected)
Comportamento atteso: Parametro invalido - warning INVALID_MINUTES_PARAM
================================================================================
âš ï¸  Warnings: ["INVALID_MINUTES_PARAM: get_first_n_minutes and get_last_n_minutes cannot be used with interval='1d'. Use get_first_n_days or get_last_n_days instead."]
âœ… OK: Parametro invalido correttamente rifiutato

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 3: start_date=2025-08-22 + end_date=2025-11-12
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 9: start + end + get_first_n_rows=10
Comportamento atteso: Prime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-08-22 00:00:00.000000
   Ultima riga timestamp: 2025-08-22 00:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 10 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 10: start + end + get_last_n_rows=10
Comportamento atteso: Ultime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-11-12 15:56:06.362000
   Ultima riga timestamp: 2025-11-12 15:59:41.887000
   Span temporale: 0 days 00:03:35.525000
   Timestamp unici: 9 su 10 righe

================================================================================
TEST 11: start + end + get_first_n_days=1
Comportamento atteso: Primo giorno nel range start-end
================================================================================
âœ… OK: 134 righe restituite
   Prima riga timestamp: 2025-08-22 00:00:00.000000
   Ultima riga timestamp: 2025-08-22 15:59:56.176000
   Span temporale: 0 days 15:59:56.176000
   Timestamp unici: 104 su 134 righe

ğŸ” DEBUG TEST 12: Investigating start + end + get_last_n_days=1

================================================================================
TEST 12: start + end + get_last_n_days=1
Comportamento atteso: Ultimo giorno nel range start-end
================================================================================
âœ… OK: 222 righe restituite
   Prima riga timestamp: 2025-11-12 00:00:00.000000
   Ultima riga timestamp: 2025-11-12 15:59:41.887000
   Span temporale: 0 days 15:59:41.887000
   Timestamp unici: 108 su 222 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 4: NESSUNA data (default)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 13: no dates + get_first_n_rows=5
Comportamento atteso: Prime 5 righe di TUTTI i dati
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-08-21 00:00:00.000000
   Ultima riga timestamp: 2025-08-21 00:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 14: no dates + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe di TUTTI i dati (piÃ¹ recenti)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-13 15:59:03.701000
   Ultima riga timestamp: 2025-11-13 15:59:50.889000
   Span temporale: 0 days 00:00:47.188000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 15: no dates + get_first_n_days=1
Comportamento atteso: Primo giorno di TUTTI i dati
================================================================================
âœ… OK: 134 righe restituite
   Prima riga timestamp: 2025-08-21 00:00:00.000000
   Ultima riga timestamp: 2025-08-21 15:59:58.719000
   Span temporale: 0 days 15:59:58.719000
   Timestamp unici: 101 su 134 righe

================================================================================
TEST 16: no dates + get_last_n_days=1
Comportamento atteso: Ultimo giorno di TUTTI i dati (piÃ¹ recente)
================================================================================
âœ… OK: 232 righe restituite
   Prima riga timestamp: 2025-11-13 00:00:00.000000
   Ultima riga timestamp: 2025-11-13 15:59:50.889000
   Span temporale: 0 days 15:59:50.889000
   Timestamp unici: 123 su 232 righe

================================================================================
SERIE: TLRY (option) - 1d - sink=parquet
================================================================================
ğŸ“… Range completo: 2025-08-22 â†’ 2025-11-13 (83 giorni)
ğŸ“… start_date usato: 2025-08-23 (day+1 dal primo)
ğŸ“… end_date usato: 2025-11-12 (day-1 dall'ultimo)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 1: SOLO start_date = 2025-08-23
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 1: start_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche dalla start_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-08-25 00:00:00.000000
   Ultima riga timestamp: 2025-08-25 00:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 2: start_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche (piÃ¹ recenti da TUTTI i dati)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-13 15:59:03.701000
   Ultima riga timestamp: 2025-11-13 15:59:50.889000
   Span temporale: 0 days 00:00:47.188000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 3: start_date + get_first_n_days=1
Comportamento atteso: Primo giorno dalla start_date
================================================================================
âŒ FAIL: Nessun dato restituito

================================================================================
TEST 4: start_date + get_first_n_minutes=5 (1d - should be rejected)
Comportamento atteso: Parametro invalido - warning INVALID_MINUTES_PARAM
================================================================================
âš ï¸  Warnings: ["INVALID_MINUTES_PARAM: get_first_n_minutes and get_last_n_minutes cannot be used with interval='1d'. Use get_first_n_days or get_last_n_days instead."]
âœ… OK: Parametro invalido correttamente rifiutato

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 2: SOLO end_date = 2025-11-12
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 5: end_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-08-22 00:00:00.000000
   Ultima riga timestamp: 2025-08-22 00:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 6: end_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-12 15:59:10.666000
   Ultima riga timestamp: 2025-11-12 15:59:41.887000
   Span temporale: 0 days 00:00:31.221000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 7: end_date + get_last_n_days=1
Comportamento atteso: Ultimo giorno fino alla end_date
================================================================================
âœ… OK: 222 righe restituite
   Prima riga timestamp: 2025-11-12 00:00:00.000000
   Ultima riga timestamp: 2025-11-12 15:59:41.887000
   Span temporale: 0 days 15:59:41.887000
   Timestamp unici: 108 su 222 righe

================================================================================
TEST 8: end_date + get_last_n_minutes=5 (1d - should be rejected)
Comportamento atteso: Parametro invalido - warning INVALID_MINUTES_PARAM
================================================================================
âš ï¸  Warnings: ["INVALID_MINUTES_PARAM: get_first_n_minutes and get_last_n_minutes cannot be used with interval='1d'. Use get_first_n_days or get_last_n_days instead."]
âœ… OK: Parametro invalido correttamente rifiutato

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 3: start_date=2025-08-23 + end_date=2025-11-12
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 9: start + end + get_first_n_rows=10
Comportamento atteso: Prime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-08-25 00:00:00.000000
   Ultima riga timestamp: 2025-08-25 09:30:11.068000
   Span temporale: 0 days 09:30:11.068000
   Timestamp unici: 2 su 10 righe

================================================================================
TEST 10: start + end + get_last_n_rows=10
Comportamento atteso: Ultime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-11-12 15:56:06.362000
   Ultima riga timestamp: 2025-11-12 15:59:41.887000
   Span temporale: 0 days 00:03:35.525000
   Timestamp unici: 9 su 10 righe

================================================================================
TEST 11: start + end + get_first_n_days=1
Comportamento atteso: Primo giorno nel range start-end
================================================================================
âŒ FAIL: Nessun dato restituito

ğŸ” DEBUG TEST 12: Investigating start + end + get_last_n_days=1

================================================================================
TEST 12: start + end + get_last_n_days=1
Comportamento atteso: Ultimo giorno nel range start-end
================================================================================
âœ… OK: 222 righe restituite
   Prima riga timestamp: 2025-11-12 00:00:00.000000
   Ultima riga timestamp: 2025-11-12 15:59:41.887000
   Span temporale: 0 days 15:59:41.887000
   Timestamp unici: 108 su 222 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 4: NESSUNA data (default)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 13: no dates + get_first_n_rows=5
Comportamento atteso: Prime 5 righe di TUTTI i dati
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-08-22 00:00:00.000000
   Ultima riga timestamp: 2025-08-22 00:00:00.000000
   Span temporale: 0 days 00:00:00
   Timestamp unici: 1 su 5 righe
   âš ï¸  Tutte le righe hanno lo stesso timestamp (diverse opzioni)

================================================================================
TEST 14: no dates + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe di TUTTI i dati (piÃ¹ recenti)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-11-13 15:59:03.701000
   Ultima riga timestamp: 2025-11-13 15:59:50.889000
   Span temporale: 0 days 00:00:47.188000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 15: no dates + get_first_n_days=1
Comportamento atteso: Primo giorno di TUTTI i dati
================================================================================
âœ… OK: 134 righe restituite
   Prima riga timestamp: 2025-08-22 00:00:00.000000
   Ultima riga timestamp: 2025-08-22 15:59:56.176000
   Span temporale: 0 days 15:59:56.176000
   Timestamp unici: 104 su 134 righe

================================================================================
TEST 16: no dates + get_last_n_days=1
Comportamento atteso: Ultimo giorno di TUTTI i dati (piÃ¹ recente)
================================================================================
âœ… OK: 232 righe restituite
   Prima riga timestamp: 2025-11-13 00:00:00.000000
   Ultima riga timestamp: 2025-11-13 15:59:50.889000
   Span temporale: 0 days 15:59:50.889000
   Timestamp unici: 123 su 232 righe

================================================================================
SERIE: SPY (option) - 1d - sink=influxdb
================================================================================
ğŸ“… Range completo: 2025-08-19 â†’ 2025-10-14 (56 giorni)
ğŸ“… start_date usato: 2025-08-20 (day+1 dal primo)
ğŸ“… end_date usato: 2025-10-13 (day-1 dall'ultimo)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 1: SOLO start_date = 2025-08-20
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 1: start_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche dalla start_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-08-20 13:30:00.048000
   Ultima riga timestamp: 2025-08-20 13:30:03.580000
   Span temporale: 0 days 00:00:03.532000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 2: start_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche (piÃ¹ recenti da TUTTI i dati)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-10-14 20:14:59.800000
   Ultima riga timestamp: 2025-10-14 20:14:59.978000
   Span temporale: 0 days 00:00:00.178000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 3: start_date + get_first_n_days=1
Comportamento atteso: Primo giorno dalla start_date
================================================================================
âœ… OK: 4433 righe restituite
   Prima riga timestamp: 2025-08-20 13:30:00.048000
   Ultima riga timestamp: 2025-08-20 20:14:59.960000
   Span temporale: 0 days 06:44:59.912000
   Timestamp unici: 4038 su 4433 righe

================================================================================
TEST 4: start_date + get_first_n_minutes=5 (1d - should be rejected)
Comportamento atteso: Parametro invalido - warning INVALID_MINUTES_PARAM
================================================================================
âš ï¸  Warnings: ["INVALID_MINUTES_PARAM: get_first_n_minutes and get_last_n_minutes cannot be used with interval='1d'. Use get_first_n_days or get_last_n_days instead."]
âœ… OK: Parametro invalido correttamente rifiutato

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 2: SOLO end_date = 2025-10-13
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 5: end_date + get_first_n_rows=5
Comportamento atteso: Prime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-08-19 13:30:00.005000
   Ultima riga timestamp: 2025-08-19 13:30:01.842000
   Span temporale: 0 days 00:00:01.837000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 6: end_date + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe cronologiche fino alla end_date
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-10-13 20:14:59.545000
   Ultima riga timestamp: 2025-10-13 20:14:59.809000
   Span temporale: 0 days 00:00:00.264000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 7: end_date + get_last_n_days=1
Comportamento atteso: Ultimo giorno fino alla end_date
================================================================================
âœ… OK: 4921 righe restituite
   Prima riga timestamp: 2025-10-13 13:30:00.007000
   Ultima riga timestamp: 2025-10-13 20:14:59.809000
   Span temporale: 0 days 06:44:59.802000
   Timestamp unici: 4464 su 4921 righe

================================================================================
TEST 8: end_date + get_last_n_minutes=5 (1d - should be rejected)
Comportamento atteso: Parametro invalido - warning INVALID_MINUTES_PARAM
================================================================================
âš ï¸  Warnings: ["INVALID_MINUTES_PARAM: get_first_n_minutes and get_last_n_minutes cannot be used with interval='1d'. Use get_first_n_days or get_last_n_days instead."]
âœ… OK: Parametro invalido correttamente rifiutato

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 3: start_date=2025-08-20 + end_date=2025-10-13
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 9: start + end + get_first_n_rows=10
Comportamento atteso: Prime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-08-20 13:30:00.048000
   Ultima riga timestamp: 2025-08-20 13:30:04.620000
   Span temporale: 0 days 00:00:04.572000
   Timestamp unici: 9 su 10 righe

================================================================================
TEST 10: start + end + get_last_n_rows=10
Comportamento atteso: Ultime 10 righe nel range start-end
================================================================================
âœ… OK: 10 righe restituite
   Prima riga timestamp: 2025-10-13 20:14:59.167000
   Ultima riga timestamp: 2025-10-13 20:14:59.809000
   Span temporale: 0 days 00:00:00.642000
   Timestamp unici: 9 su 10 righe

================================================================================
TEST 11: start + end + get_first_n_days=1
Comportamento atteso: Primo giorno nel range start-end
================================================================================
âœ… OK: 4433 righe restituite
   Prima riga timestamp: 2025-08-20 13:30:00.048000
   Ultima riga timestamp: 2025-08-20 20:14:59.960000
   Span temporale: 0 days 06:44:59.912000
   Timestamp unici: 4038 su 4433 righe

ğŸ” DEBUG TEST 12: Investigating start + end + get_last_n_days=1

================================================================================
TEST 12: start + end + get_last_n_days=1
Comportamento atteso: Ultimo giorno nel range start-end
================================================================================
âœ… OK: 4921 righe restituite
   Prima riga timestamp: 2025-10-13 13:30:00.007000
   Ultima riga timestamp: 2025-10-13 20:14:59.809000
   Span temporale: 0 days 06:44:59.802000
   Timestamp unici: 4464 su 4921 righe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCENARIO 4: NESSUNA data (default)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
TEST 13: no dates + get_first_n_rows=5
Comportamento atteso: Prime 5 righe di TUTTI i dati
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-08-19 13:30:00.005000
   Ultima riga timestamp: 2025-08-19 13:30:01.842000
   Span temporale: 0 days 00:00:01.837000
   Timestamp unici: 5 su 5 righe

================================================================================
TEST 14: no dates + get_last_n_rows=5
Comportamento atteso: Ultime 5 righe di TUTTI i dati (piÃ¹ recenti)
================================================================================
âœ… OK: 5 righe restituite
   Prima riga timestamp: 2025-10-14 20:14:59.800000
   Ultima riga timestamp: 2025-10-14 20:14:59.978000
   Span temporale: 0 days 00:00:00.178000
   Timestamp unici: 4 su 5 righe

================================================================================
TEST 15: no dates + get_first_n_days=1
Comportamento atteso: Primo giorno di TUTTI i dati
================================================================================
âœ… OK: 4341 righe restituite
   Prima riga timestamp: 2025-08-19 13:30:00.005000
   Ultima riga timestamp: 2025-08-19 20:14:59.547000
   Span temporale: 0 days 06:44:59.542000
   Timestamp unici: 3942 su 4341 righe

================================================================================
TEST 16: no dates + get_last_n_days=1
Comportamento atteso: Ultimo giorno di TUTTI i dati (piÃ¹ recente)
================================================================================
âœ… OK: 4951 righe restituite
   Prima riga timestamp: 2025-10-14 13:30:00.409000
   Ultima riga timestamp: 2025-10-14 20:14:59.978000
   Span temporale: 0 days 06:44:59.569000
   Timestamp unici: 4594 su 4951 righe

################################################################################
# SUMMARY - ALL TESTS
################################################################################

   Test   Interval     Sink Status
 TEST 1       TICK      csv   PASS
 TEST 2       TICK      csv   PASS
 TEST 3       TICK      csv   PASS
 TEST 4       TICK      csv   PASS
 TEST 5       TICK      csv   PASS
 TEST 6       TICK      csv   PASS
 TEST 7       TICK      csv   PASS
 TEST 8       TICK      csv   PASS
 TEST 9       TICK      csv   PASS
TEST 10       TICK      csv   PASS
TEST 11       TICK      csv   PASS
TEST 12       TICK      csv   PASS
TEST 13       TICK      csv   PASS
TEST 14       TICK      csv   PASS
TEST 15       TICK      csv   PASS
TEST 16       TICK      csv   PASS
 TEST 1       TICK  parquet   PASS
 TEST 2       TICK  parquet   PASS
 TEST 3       TICK  parquet   PASS
 TEST 4       TICK  parquet   PASS
 TEST 5       TICK  parquet   PASS
 TEST 6       TICK  parquet   PASS
 TEST 7       TICK  parquet   PASS
 TEST 8       TICK  parquet   PASS
 TEST 9       TICK  parquet   PASS
TEST 10       TICK  parquet   PASS
TEST 11       TICK  parquet   PASS
TEST 12       TICK  parquet   PASS
 TEST 1       TICK influxdb   PASS
 TEST 2       TICK influxdb   PASS
 TEST 3       TICK influxdb   PASS
 TEST 4       TICK influxdb   PASS
 TEST 5       TICK influxdb   PASS
 TEST 6       TICK influxdb   PASS
 TEST 7       TICK influxdb   PASS
 TEST 8       TICK influxdb   PASS
 TEST 9       TICK influxdb   PASS
TEST 10       TICK influxdb   PASS
TEST 11       TICK influxdb   PASS
TEST 12       TICK influxdb   PASS
TEST 13       TICK influxdb   PASS
TEST 14       TICK influxdb   PASS
TEST 15       TICK influxdb   PASS
TEST 16       TICK influxdb   PASS
 TEST 1    MINUTES      csv   PASS
 TEST 2    MINUTES      csv   PASS
 TEST 3    MINUTES      csv   PASS
 TEST 4    MINUTES      csv   PASS
 TEST 5    MINUTES      csv   PASS
 TEST 6    MINUTES      csv   PASS
 TEST 7    MINUTES      csv   PASS
 TEST 8    MINUTES      csv   PASS
 TEST 9    MINUTES      csv   PASS
TEST 10    MINUTES      csv   PASS
TEST 11    MINUTES      csv   PASS
TEST 12    MINUTES      csv   PASS
 TEST 1    MINUTES influxdb   PASS
 TEST 2    MINUTES influxdb   PASS
 TEST 3    MINUTES influxdb   PASS
 TEST 4    MINUTES influxdb   PASS
 TEST 5    MINUTES influxdb   PASS
 TEST 6    MINUTES influxdb   PASS
 TEST 7    MINUTES influxdb   FAIL
 TEST 8    MINUTES influxdb   PASS
 TEST 9    MINUTES influxdb   PASS
TEST 10    MINUTES influxdb   PASS
TEST 11    MINUTES influxdb   PASS
TEST 12    MINUTES influxdb   FAIL
TEST 13    MINUTES influxdb   PASS
TEST 14    MINUTES influxdb   PASS
TEST 15    MINUTES influxdb   PASS
TEST 16    MINUTES influxdb   PASS
 TEST 1 DAILY (1d)      csv   PASS
 TEST 2 DAILY (1d)      csv   PASS
 TEST 3 DAILY (1d)      csv   PASS
 TEST 4 DAILY (1d)      csv   PASS
 TEST 5 DAILY (1d)      csv   PASS
 TEST 6 DAILY (1d)      csv   PASS
 TEST 7 DAILY (1d)      csv   PASS
 TEST 8 DAILY (1d)      csv   PASS
 TEST 9 DAILY (1d)      csv   PASS
TEST 10 DAILY (1d)      csv   PASS
TEST 11 DAILY (1d)      csv   PASS
TEST 12 DAILY (1d)      csv   PASS
TEST 13 DAILY (1d)      csv   PASS
TEST 14 DAILY (1d)      csv   PASS
TEST 15 DAILY (1d)      csv   PASS
TEST 16 DAILY (1d)      csv   PASS
 TEST 1 DAILY (1d)  parquet   PASS
 TEST 2 DAILY (1d)  parquet   PASS
 TEST 3 DAILY (1d)  parquet   FAIL
 TEST 4 DAILY (1d)  parquet   PASS
 TEST 5 DAILY (1d)  parquet   PASS
 TEST 6 DAILY (1d)  parquet   PASS
 TEST 7 DAILY (1d)  parquet   PASS
 TEST 8 DAILY (1d)  parquet   PASS
 TEST 9 DAILY (1d)  parquet   PASS
TEST 10 DAILY (1d)  parquet   PASS
TEST 11 DAILY (1d)  parquet   FAIL
TEST 12 DAILY (1d)  parquet   PASS
TEST 13 DAILY (1d)  parquet   PASS
TEST 14 DAILY (1d)  parquet   PASS
TEST 15 DAILY (1d)  parquet   PASS
TEST 16 DAILY (1d)  parquet   PASS
 TEST 1 DAILY (1d) influxdb   PASS
 TEST 2 DAILY (1d) influxdb   PASS
 TEST 3 DAILY (1d) influxdb   PASS
 TEST 4 DAILY (1d) influxdb   PASS
 TEST 5 DAILY (1d) influxdb   PASS
 TEST 6 DAILY (1d) influxdb   PASS
 TEST 7 DAILY (1d) influxdb   PASS
 TEST 8 DAILY (1d) influxdb   PASS
 TEST 9 DAILY (1d) influxdb   PASS
TEST 10 DAILY (1d) influxdb   PASS
TEST 11 DAILY (1d) influxdb   PASS
TEST 12 DAILY (1d) influxdb   PASS
TEST 13 DAILY (1d) influxdb   PASS
TEST 14 DAILY (1d) influxdb   PASS
TEST 15 DAILY (1d) influxdb   PASS
TEST 16 DAILY (1d) influxdb   PASS

================================================================================
Total tests: 120
âœ… Passed: 116
âŒ Failed: 4
Success rate: 96.7%
================================================================================